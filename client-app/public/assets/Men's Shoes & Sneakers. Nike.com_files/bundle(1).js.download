(()=>{"use strict";var n,e=function(){return n=void 0,e=void 0,o=function(){var n,e;return function(n,e){var t,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;r&&(r=0,l[0]&&(a=0)),a;)try{if(t=1,o&&(i=2&l[0]?o.return:l[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,l[1])).done)return i;switch(o=0,i&&(l=[2&l[0],i.value]),l[0]){case 0:case 1:i=l;break;case 4:return a.label++,{value:l[1],done:!1};case 5:a.label++,o=l[1],l=[0];continue;case 7:l=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==l[0]&&2!==l[0])){a=0;continue}if(3===l[0]&&(!i||l[1]>i[0]&&l[1]<i[3])){a.label=l[1];break}if(6===l[0]&&a.label<i[1]){a.label=i[1],i=l;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(l);break}i[2]&&a.ops.pop(),a.trys.pop();continue}l=e.call(n,a)}catch(n){l=[6,n],o=0}finally{t=i=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}}(this,(function(t){switch(t.label){case 0:return[4,null===(e=window.webShellClient)||void 0===e?void 0:e.identity.getUserProfile()];case 1:return[2,{userId:null==(n=t.sent())?void 0:n.upmId,loggedIn:!!(null==n?void 0:n.upmId)}]}}))},new((t=void 0)||(t=Promise))((function(i,r){function a(n){try{c(o.next(n))}catch(n){r(n)}}function l(n){try{c(o.throw(n))}catch(n){r(n)}}function c(n){var e;n.done?i(n.value):(e=n.value,e instanceof t?e:new t((function(n){n(e)}))).then(a,l)}c((o=o.apply(n,e||[])).next())}));var n,e,t,o},t=function(){return t=Object.assign||function(n){for(var e,t=1,o=arguments.length;t<o;t++)for(var i in e=arguments[t])Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i]);return n},t.apply(this,arguments)},o=function(){return o=Object.assign||function(n){for(var e,t=1,o=arguments.length;t<o;t++)for(var i in e=arguments[t])Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i]);return n},o.apply(this,arguments)};!function(n){n[n.CONTINUE=0]="CONTINUE",n[n.STOP=1]="STOP"}(n||(n={}));var i,r=function(){function e(){this.maxAttempts=10,this.interval=50,this.exponentRate=1.5}return e.run=function(e){var t=function(o){if(void 0===o&&(o=0),function(t){try{return e.onTick(t)}catch(t){return e.onError(t),n.STOP}}(o)!==n.STOP)if(o+1>=e.maxAttempts)e.onTimeout();else{var i=e.interval*Math.pow(o+1,e.exponentRate);setTimeout((function(){return t(o+1)}),i)}};return t(),e},e.runAsync=function(t){return new Promise((function(i,r){e.run(o(o({},new e),{onTick:function(){var e=t();return e?(i(e),n.STOP):n.CONTINUE},onError:r,onTimeout:function(){return i(null)}}))}))},e}(),a=(i=function(n,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,e){n.__proto__=e}||function(n,e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t])},i(n,e)},function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=n}i(n,e),n.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}),l=function(){return l=Object.assign||function(n){for(var e,t=1,o=arguments.length;t<o;t++)for(var i in e=arguments[t])Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i]);return n},l.apply(this,arguments)},c=function(n,e,t,o){return new(t||(t=Promise))((function(i,r){function a(n){try{c(o.next(n))}catch(n){r(n)}}function l(n){try{c(o.throw(n))}catch(n){r(n)}}function c(n){var e;n.done?i(n.value):(e=n.value,e instanceof t?e:new t((function(n){n(e)}))).then(a,l)}c((o=o.apply(n,e||[])).next())}))},u=function(n,e){var t,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;r&&(r=0,l[0]&&(a=0)),a;)try{if(t=1,o&&(i=2&l[0]?o.return:l[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,l[1])).done)return i;switch(o=0,i&&(l=[2&l[0],i.value]),l[0]){case 0:case 1:i=l;break;case 4:return a.label++,{value:l[1],done:!1};case 5:a.label++,o=l[1],l=[0];continue;case 7:l=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==l[0]&&2!==l[0])){a=0;continue}if(3===l[0]&&(!i||l[1]>i[0]&&l[1]<i[3])){a.label=l[1];break}if(6===l[0]&&a.label<i[1]){a.label=i[1],i=l;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(l);break}i[2]&&a.ops.pop(),a.trys.pop();continue}l=e.call(n,a)}catch(n){l=[6,n],o=0}finally{t=i=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}},s="adtargeting_behavioralevents",d="performance",v=function(n){function o(t){var o,i=n.call(this,t)||this;return i.getLocations=function(n){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];return c(i,function(n,e,t){if(t||2===arguments.length)for(var o,i=0,r=e.length;i<r;i++)!o&&i in e||(o||(o=Array.prototype.slice.call(e,0,i)),o[i]=e[i]);return n.concat(o||Array.prototype.slice.call(e))}([n],t,!0),void 0,(function(n,t){var o,i,r,a,l,c,v,p,f,w,h,g,y,b,m,_,T;return void 0===t&&(t=!1),u(this,(function(u){switch(u.label){case 0:return o=null!==(p=null==n?void 0:n.locations)&&void 0!==p?p:this._locations,[4,this.getAdobeATSdk()];case 1:if(!(null==(i=u.sent())?void 0:i.target))return console.warn("Optimization client is unable to find Adobe Target. Please check that your application is configured correctly."),[2];if(0===o.length)return console.error("Locations must be provided either via a function argument or as a part of the Optimization configuration"),null===(f=window.newrelic)||void 0===f||f.addPageAction("EXP_OPTIMIZATION_CLIENT_NO_LOCATIONS",{errorMessage:"Locations must be provided."}),[2];A=o,(O=new URL(window.location.href).searchParams.get("atLocation"))&&(A[0].name=O),I=o,new URL(window.location.href).searchParams.forEach((function(n,e){if(e.indexOf("mbox:")>=0){var t=e.split(":")[1];I[0].parameters[t]=n}})),u.label=2;case 2:return u.trys.push([2,6,,7]),[4,e()];case 3:return r=u.sent(),a=this.getOptions(o),[4,null===(w=window.analyticsClient)||void 0===w?void 0:w.isInitialized()];case 4:return u.sent(),l=null===(g=null===(h=null===window||void 0===window?void 0:window.NikePrivacy)||void 0===h?void 0:h.permissions.get())||void 0===g?void 0:g.map((function(n){var e=n.category;return n.isEnabled?e:null})).filter(Boolean),[s,d].every((function(n){return null==l?void 0:l.includes(n)}))?(window.Visitor&&this.setCustomerIDs(r),[4,window.adobe.target.getOffers(a)]):(console.warn("Appropriate UGP permissions have not been given. Cannot fetch Adobe Target locations."),null===(y=window.newrelic)||void 0===y||y.addPageAction("EXP_OPTIMIZATION_CLIENT_NO_UGP_PERMISSION",{errorMessage:"Appropriate UGP permissions have not been given.",locations:o}),[2]);case 5:return c=u.sent(),null===(b=window.newrelic)||void 0===b||b.addPageAction("EXP_OPTIMIZATION_CLIENT_SUCCESS",{}),[2,this.transformAdobeOffersToGetLocationsResult(c,t)];case 6:return v=u.sent(),(null===(m=window.newrelic)||void 0===m?void 0:m.noticeError)&&(null===(_=window.newrelic)||void 0===_||_.addPageAction("EXP_OPTIMIZATION_CLIENT_ERROR",{host:window.location.host,errorName:v.name,errorMessage:v.message,stackTrace:null!==(T=v.stack)&&void 0!==T?T:"",locations:o.length?o:null})),console.error("Failed to find locations: ".concat(v.message)),[3,7];case 7:return[2]}var I,A,O}))}))},i.getOptions=function(n){return{request:{context:{channel:"web"},experienceCloud:{analytics:{logging:"client_side"}},property:{token:(e=new URL(window.location.href).searchParams.get("atProperty"),e||"ae0ecea9-920a-26c9-5042-3a3aab0ff68b")},execute:{mboxes:n.map((function(n,e){return{name:n.name,index:e,parameters:n.parameters}}))}}};var e},i.transformAdobeOffersToGetLocationsResult=function(n,e){for(var t,o,r,a=[],l=function(n){var l={name:n.name,analytics:null===(t=n.analytics)||void 0===t?void 0:t.payload.tnta,content:null===(r=null===(o=null==n?void 0:n.options)||void 0===o?void 0:o[0])||void 0===r?void 0:r.content,experimentActivatedCallback:function(){}};if(l.analytics){var c=function(){var e;try{return i.sendAdobeAnalyticsEvent(n),!0}catch(n){return window.newrelic&&window.newrelic.addPageAction("OPTIMIZATION_CLIENT_ANALTICS_SEND_ERROR",{host:window.location.host,errorName:n.name,errorMessage:n.message,stackTrace:null!==(e=n.stack)&&void 0!==e?e:""}),console.error("Failed to send Analytics: ".concat(n.message)),!1}finally{l.experimentActivatedCallback=function(){}}};e?l.experimentActivatedCallback=c:c()}a.push(l)},c=0,u=n.execute.mboxes;c<u.length;c++)l(u[c]);if(a&&a.length>0)return{locations:a}},null===(o=window.newrelic)||void 0===o||o.addPageAction("EXP_OPTIMIZATION_CLIENT_INITIALIZED",{}),i}return a(o,n),o.prototype.setCustomerIDs=function(n){var e=window.Visitor.getInstance("F0935E09512D2C270A490D4D@AdobeOrg");e.setCustomerIDs({customerecid:{id:e.getMarketingCloudVisitorID(),authState:n.loggedIn?window.Visitor.AuthState.AUTHENTICATED:window.Visitor.AuthState.UNKNOWN}})},o.prototype.validExperiment=function(n){return void 0!==n.content},o.prototype.sendAdobeAnalyticsEvent=function(n){var e,o,i,r,a,c=function(n){var e,o,i,r,a,l,c,u,s,d;try{var v=function(n){var e,t,o,i,r,a=n.location.href,l={"/t/":"pdp","/t-dark/":"pdp","/u-dark/":"pdp","/u/":"pdp","/w/":"pw","/w-dark/":"pw","/cart":"cart","/checkout":"checkout"};if(a){var c=!1;Object.keys(l).forEach((function(n){!c&&a.includes(n)&&(c=!0,r=l[n])}))}if(!r)try{r=null===(i=null===(o=null===(t=null===(e=n.__NEXT_DATA__)||void 0===e?void 0:e.props)||void 0===t?void 0:t.pageProps)||void 0===o?void 0:o.navConfig)||void 0===i?void 0:i.analyticsPageType}catch(n){}return r}(n),p=function(n,e){var t,o,i,r,a,l,c,u,s,d,v,p,f,w,h,g,y,b,m;switch(e){case"pdp":(b=null===(o=null===(t=n.__NEXT_DATA__)||void 0===t?void 0:t.query)||void 0===o?void 0:o.slug)&&b.includes("-")&&(m=b.substring(0,b.lastIndexOf("-")).replace(/-/g," ")),y=m;break;case"pw":y=null===(u=null===(c=null===(l=null===(a=null===(r=null===(i=n.__NEXT_DATA__)||void 0===i?void 0:i.props)||void 0===r?void 0:r.pageProps)||void 0===a?void 0:a.initialState)||void 0===l?void 0:l.Wall)||void 0===c?void 0:c.primaryHeading)||void 0===u?void 0:u.toLowerCase();break;case"homepage":y=null===(p=null===(v=null===(d=null===(s=n.__NEXT_DATA__)||void 0===s?void 0:s.props)||void 0===d?void 0:d.pageProps)||void 0===v?void 0:v.navConfig)||void 0===p?void 0:p.pageDetail;break;case"landing page":var _=null===(g=null===(h=null===(w=null===(f=n.__NEXT_DATA__)||void 0===f?void 0:f.props)||void 0===w?void 0:w.pageProps)||void 0===h?void 0:h.navConfig)||void 0===g?void 0:g.pageDetail;_&&(y="".concat(_,":land"));break;case"cart":y="cart>view";break;case"checkout":y="checkout>checkout"}return y}(n,v),f=function(n){var e;switch(n){case"pdp":case"homepage":case"landing page":case"cart":case"checkout":e=n;break;case"pw":e="product wall"}return e}(v),w=null===(i=null===(o=null===(e=null==n?void 0:n.webShellClient)||void 0===e?void 0:e.locale)||void 0===o?void 0:o.get())||void 0===i?void 0:i.currency,h=t({domain:"www.nike.com",backendPlatform:"cloud"},(d=f)&&{name:d}),g=function(n,e){return t(t(t({experienceType:"nikecom"},n&&{pageName:"nikecom>".concat(n)}),n&&{pageDetail:n}),e&&{pageType:e})}(p,v),y=function(n){return{language:(null==n?void 0:n.language)||"en",country:(null==n?void 0:n.country)||"us"}}(null===(a=null===(r=n.webShellClient)||void 0===r?void 0:r.locale)||void 0===a?void 0:a.get());return t(t({app:h,view:g},w&&{currency:w}),{language:(null===(u=null===(c=null===(l=n.webShellClient)||void 0===l?void 0:l.locale)||void 0===c?void 0:c.get())||void 0===u?void 0:u.langRegion)||"en_US",locale:y})}catch(e){return n.newrelic&&n.newrelic.addPageAction("OPTIMIZATION_CLIENT_COMMON_PROPERTIES_ERROR",{host:n.location.host,errorName:e.name,errorMessage:e.message,stackTrace:null!==(s=e.stack)&&void 0!==s?s:""}),console.error("Failed to get common properties: ".concat(e.message)),{app:{backendPlatform:"",domain:"",name:"",version:""},view:{experienceType:"",pageName:"",pageType:"",pageDetail:""},language:"",locale:{country:"",language:""},currency:""}}}(window);window.webShellClient.analytics.track("Experiment Activated",l({"experience.name":null===(o=null===(e=null==n?void 0:n.options)||void 0===e?void 0:e[0])||void 0===o?void 0:o.responseTokens["experience.name"],"activity.name":null===(r=null===(i=null==n?void 0:n.options)||void 0===i?void 0:i[0])||void 0===r?void 0:r.responseTokens["activity.name"],abTest:{analytics:null===(a=n.analytics)||void 0===a?void 0:a.payload.tnta}},c))},o.prototype.getAdobeATSdk=function(){return c(this,void 0,void 0,(function(){return u(this,(function(n){return[2,r.runAsync((function(){return window.adobe}))]}))}))},o}((function(n){this._locations=[],n&&(this._locations=n)})),p=function(){function n(n){var t=this;this.generateGlobalMbox=function(){e().then((function(n){var e,o,i,r=n.loggedIn,a=n.userId,l={appCountry:null===(o=null===(e=t._window.webShellClient)||void 0===e?void 0:e.locale.get().country)||void 0===o?void 0:o.toUpperCase(),appLanguage:null===(i=t._window.webShellClient)||void 0===i?void 0:i.locale.get().language,browserWidth:t._window.innerWidth};t._window.targetPageParamsAll=function(){return l.profile={loggedIn:r,userId:a},l}})).catch((function(n){var e;console.warn({error:n,cmsg:"Global mbox param init is failed.."}),null===(e=t._window.newrelic)||void 0===e||e.addPageAction("EXP_OPTIMIZATION_CLIENT_ERROR",{errorMessage:"Global mbox param init is failed."})}))},this._window=n}return n.prototype.init=function(){this.generateGlobalMbox()},n}(),f=function(n,e,t,o){return new(t||(t=Promise))((function(i,r){function a(n){try{c(o.next(n))}catch(n){r(n)}}function l(n){try{c(o.throw(n))}catch(n){r(n)}}function c(n){var e;n.done?i(n.value):(e=n.value,e instanceof t?e:new t((function(n){n(e)}))).then(a,l)}c((o=o.apply(n,e||[])).next())}))},w=function(n,e){var t,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;r&&(r=0,l[0]&&(a=0)),a;)try{if(t=1,o&&(i=2&l[0]?o.return:l[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,l[1])).done)return i;switch(o=0,i&&(l=[2&l[0],i.value]),l[0]){case 0:case 1:i=l;break;case 4:return a.label++,{value:l[1],done:!1};case 5:a.label++,o=l[1],l=[0];continue;case 7:l=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==l[0]&&2!==l[0])){a=0;continue}if(3===l[0]&&(!i||l[1]>i[0]&&l[1]<i[3])){a.label=l[1];break}if(6===l[0]&&a.label<i[1]){a.label=i[1],i=l;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(l);break}i[2]&&a.ops.pop(),a.trys.pop();continue}l=e.call(n,a)}catch(n){l=[6,n],o=0}finally{t=i=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}};function h(n){return f(this,void 0,void 0,(function(){function e(){return f(this,void 0,void 0,(function(){return w(this,(function(n){return o.optimization.getLocations=t,o.optimization.__WS_UNSTABLE__.getLocations=t,[2]}))}))}var t,o,i;return w(this,(function(r){switch(r.label){case 0:return t=new v([]).getLocations,new p(n).init(),o=n.webShellClient,void 0!==n&&(null===(i=n.newrelic)||void 0===i||i.addPageAction("OPTIMIZATION_CLIENT_INITIALIZED",{})),[4,e()];case 1:return r.sent(),[2]}}))}))}!function(n){f(this,void 0,void 0,(function(){return w(this,(function(e){switch(e.label){case 0:return n.webShellClient?[4,h(n)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}(window)})();